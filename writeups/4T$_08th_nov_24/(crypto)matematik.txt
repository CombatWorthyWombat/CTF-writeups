Matematik

Ok, I got carried away. Sam and Mikaela helped me again to improve everything.

If this does not work you will have won for this year and I will acknowledge your strength.

Good luck.

=================================

we get a file called "source"

displays a RSA encryption algorithm

def gen_key():
    p = getPrime(2048)
    q = getPrime(2048)
    n = p * q
    phi_n = (p - 1) * (q - 1)

-----------------------------------------
all pretty normal so far
-----------------------------------------

    d = getRandomNBitInteger(1024)
    while (3 * d)**4 < n < d**0.292:
        d = getRandomNBitInteger(1024)

-----------------------------------------
seems like normal generation of decode exponent here
-----------------------------------------

    e = pow(d, -1, phi_n)

    return (n, e), (n, d)


def encrypt(pt: int, pub_key: (int, int)) -> int:
    n, e = pub_key
    return pow(pt, e, n)


def decrypt(ct: int, priv_key: (int, int)) -> int:
    n, d = priv_key
    return pow(ct, d, n)


pt = bytes_to_long(FLAG_MATEMATIK)
pub, priv = gen_key()

ct = encrypt(pt, pub)

print(pub)
print(ct)

-----------------------------------------
all back to normal RSA (although they changed from cf -> ct for ciphertext again)
-----------------------------------------

2048 RSA keygen

we are given the following as outputs:

n = 813291308603414089290668124041839733918488102866707584478634305319455045742732398934285162590313628856151815805790620427282606419733953720940672900768927843456798354736166539116245629511099027050834359384831529357375361650207922031319202531732346130779684513880916453362321181490895712150208665938936278172640305188677018153679323752530891790061335976403796874283838241633986457526745812030002471049604945974200148937982826320771554655435614757483499493911336752954800985578910845367956516996617229558390523818494709361186658914477419251812995871366351489494308292606000804614366845051918199227844254546329541843568318237109632457847134885083162397820112825732852216955328660838562813889545261894305894160609220887968790944587321188098754603643013421664631133010093611556497233001653201895232543427082211683021364712220647876947616554074640514028751536406658385579193774470930187879078899695146964706436953032128385848122414086434213809075484348842559074698856998042069709556057058143190691596178593402659233400344987806988713656452553047776818230138111821734002434933579554120175239589824745274138505528074316535235675310159751338868381402667299087497293471199173475186425479086169119058202621574904341235785246634876364612171762039
e = 507629470812273261823426390546598338984395989442071474050416785320440010159634016383832635630627366973849528238182510962137111640508110790495315940357236952175068500887330221534610953600273841963487815952694025077621388297338394497587374864453412549069891512740981002243575242455039752608668327752194980276553830616717081535140131472469003490922930873685871639979453889383771636442013652167366168345651503969931023708386430496255530725148293969510474787981494451982469823070955933396841763617850694834638657960004417960227867460846597255166692801940250504317372628474735332077991643792461076896124636935163284072466415339475869348991747659374068270652923128794611435079728489232122948179139197547105159952184231485291647613944223516450080883783540351500360106831879612194331391872641037161673244469591268235189667939691167302161427391206555938078520320564149433927306713056434689300750584217302607803804849162996945453960388589576433514450931587322042461589005902688639249894585367101942527518672906958428684989901046887818040748667377553642721872919254441104379963680746321602265998423512578545469859243244107381159471514440291591999221623568031461898015393860750228229154460555520746111342574014851882064314878187293289220899929807
ct = 556929789932718354289291849394616085746017472924699209648914037202503416575540852830970664161255326023268634267454107774965420213413821042576276508575455454361523573097884468178170003077347056594772266618658709362255877582064457508199710666562370947380840565162429512173936308204532454076794768514066924004746803038256412552237658292113081608006251236076708578344122432586668187584141207615427828061411854105828515375964545783967241743237338987432939077584028379144738368932124095367932978939269991855150473979077827471523074357255458371128658173282444008289098805775210188129191929555599684770996221844343085502091025637291770521228572273689936242153064802513056303923914150604670956717223303806593746367470261209586104020700589223881827015327135689001439309533530597224229719728250381029314935622264783085597813127891143325840103161823613658376562092838968353695725179031099723570207527561818677173920140026394852719332897635673091839874217580098458961022224756236920496049672662910077320373061540661712874310205443131382764229256203955927297599654747525835793142357208317882463486124468731953065393841513854916505999541748109264234674614040515601134746212095952825656454587128065358700074118271602538129048748869380854865933904021

first reaction is that e is a very large value, so its use as an exponent in the mod function will be weaker

wiener attack using high e value -> successful

p = 31532549669471427713464806538334005679650090661013782201794782436597592318434189289021810723094193958838371309427532523548311055649385002984839091443542719101550754616338328185967424860402939446465375499428502694285063036080307583590171379541637518882531081483503788698303866691094654700342852014479000352319319723070158926668898181275607035979930917095633639198352278407495241480524645237905288571106738326793846286681331419491779244215661807583815294776720133711232715229778587296876722635528555334274024119929098177747053093540539990083229290923948220066272446368018925294721812688184603596051722312205938974943221
q = 25792120114879599877099960207931746202460398386745206424165631733142228015737295213672876346746765605354697729396133550907756362394888741172541421400348182958273856151862660846520723483369414767843868073699377349600185765265165538941731164863680657380450888304086373990669770665398169875362781812575089127982328181892049874576313087600060190574318896370394938386157092264363059297534127454212490065365103264809740692062574743938372870444916781381852056194973353126576533793787442419470766662965495738611393310582956445998101866795070565726504308836293587180503478765781214696790772487661938099887250250402963014272059

